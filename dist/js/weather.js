var weather=angular.module("ssweather",[]);weather.controller("weatherController",["$scope","$http",function(e,t){e.tips=[],e.city="上海",e.temperature="12",e.humidity=35,e.setHumidity=function(e){var t=document.querySelector(".rightRotate"),r=document.querySelector(".leftRotate");50>e?(console.log("h:"+e),t.style.transform="rotate("+(3.6*e+45)+"deg)"):(console.log("h:"+e),t.style.transform="rotate(225deg)",r.style.transform="rotate("+(3.6*(e-50)+45)+"deg)")},e.getWeatherNow=function(r){var o="https://api.thinkpage.cn/v2/weather/now.json?language=zh-chs&unit=c&key=STUQDFMKSP&city=";o+=r,e.city=r,t({method:"GET",url:o}).then(function(t){var r=t.data.weather;console.log(r[0].now.temperature),e.temperature=r[0].now.temperature,e.humidity=r[0].now.humidity,e.setHumidity(e.humidity)},function(e){console.log("get weather now error:"+e)})};var r=function(r){var o="https://api.thinkpage.cn/v3/weather/daily.json?key=STUQDFMKSP&language=zh-Hans&unit=c&start=0&days=5";o+="&location="+r,t({method:"GET",url:o}).then(function(t){var r=t.data.results[0].daily;e.day1=r[0].date.substr(5),e.day2=r[1].date.substr(5),e.textDay1=r[0].text_day,e.textDay2=r[1].text_day,e.low1=r[0].low,e.low2=r[1].low,e.high1=r[0].high,e.high2=r[1].high,e.w1=r[0].code_day,e.w2=r[1].code_day},function(e){console.log("get future weather error:"),console.log("city:"+r+"-->"+e.data.status)})};e.hideAsk=function(){var e=document.querySelector(".contact-bar"),t=document.querySelector(".askLocation"),r=document.querySelector(".for-location"),o=document.querySelector(".where");e.style.display="",t.style.display="none",r.innerHTML="",o.value=""},function(){var t=document.querySelector(".where"),r=document.querySelector(".for-location"),o=0;EventUtil.addHandler(t,"input",function(){var n=new RegExp("^"+t.value+".*$","im");e.tips=[],o=0;for(var a=0;a<citys.length&&!(o>2);a++)n.test(citys[a][0])&&(e.tips.push(citys[a][0]),o++);r.innerHTML="";for(var a=0;a<e.tips.length;a++){var i=document.createElement("li");i.innerHTML=e.tips[a],EventUtil.addHandler(i,"click",function(t){e.getWeatherNow(t.target.innerHTML),e.hideAsk()}),r.appendChild(i)}})}(),function(){var t=document.querySelector(".day-text");document.querySelector(".refresh");EventUtil.addHandler(t,"click",function(){var t=document.querySelector(".future-weather");"none"===t.style.display&&r(e.city)})}(),function(){var t=document.querySelector(".refresh").firstChild;EventUtil.addHandler(t,"click",function(){var r=t.className;t.className+=" is-active",setTimeout(function(){t.className=r},1e3),e.getWeatherNow(e.city)})}()}]);